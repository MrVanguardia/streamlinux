# Cleartext Traffic Enabled in Android Client Allows MITM Attacks on WebRTC Signaling

**ID:** vuln-0013
**Severity:** HIGH
**Found:** 2026-01-26 04:36:30 UTC
**Target:** StreamLinux Android Client - android-client/app/src/main/AndroidManifest.xml
**Endpoint:** /ws/signaling
**Method:** WebSocket
**CVSS:** 8.1

## Description

A critical network security vulnerability exists in StreamLinux Android client due to cleartext traffic being enabled via `android:usesCleartextTraffic="true"` in AndroidManifest.xml (line 26). This configuration, combined with absence of certificate pinning in OkHttp WebSocket client, allows attackers to perform Man-In-The-Middle (MITM) attacks and intercept all WebSocket signaling traffic between Android client and signaling server.

## Impact

An attacker on the same local network can intercept complete WebRTC session establishment, including SDP offers/answers, ICE candidates with IP addresses, peer IDs, and room IDs. This allows stream hijacking, network discovery, session tracking, credential exposure, and privacy violations. Complete compromise of session confidentiality and integrity is possible.

## Technical Analysis

The vulnerability stems from three security deficiencies: (1) `android:usesCleartextTraffic="true"` in AndroidManifest.xml line 26 permits unencrypted HTTP and WebSocket connections, (2) OkHttp WebSocket client in SignalingClient.kt line 93 lacks certificate pinning and custom SSL validation, and (3) No network_security_config.xml exists to enforce HTTPS/WSS restrictions. This allows any CA-signed certificate to be trusted and all signaling messages to be transmitted in plaintext, exposing SDP, ICE candidates, peer IDs, and session state.

## Remediation

Priority 0 (CRITICAL): (1) Create network_security_config.xml at android-client/app/src/main/res/xml/ with cleartextTrafficPermitted="false", (2) Update AndroidManifest.xml to remove android:usesCleartextTraffic="true" and add android:networkSecurityConfig="@xml/network_security_config", (3) Implement certificate pinning in SignalingClient.kt using CertificatePinner.Builder. Priority 1 (HIGH): Enable hostname verification, enforce TLS 1.3 only, add certificate transparency checks, implement proper error handling for cert failures. Priority 2 (MEDIUM): Add certificate revocation checking, implement HSTS, add security headers, implement certificate pinning rotation mechanism.

